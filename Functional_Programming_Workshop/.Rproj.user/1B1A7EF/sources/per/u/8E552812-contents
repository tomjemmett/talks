library(tidyverse)

# generate n rows of data
n <- 1000

# generate a table with n rows of data with columns named a, b, c, d
df <- letters[1:4] %>%
  # calling set_names with no arguments set's the vectors names to be the items
  # from the vector: when we call map_dfr it will create a table with these names
  # as the column names
  set_names() %>%
  # sample from the numbers 1:5 and NA n times
  map_dfr(~sample(c(1:5, NA), n, replace = TRUE)) %>%
  # add an id column and move it to the beginning
  mutate(id = row_number()) %>%
  select(id, everything())

# create a column called na_cols which counts how many of the values in each row
# are na. first convert the column values to be TRUE/FALSE if na/not na, then
# over all columns sum the TRUE values to count the NA's
df %>%
  mutate(na_cols = df %>%
           select(a:d) %>%
           map(is.na) %>%
           pmap_dbl(sum))
